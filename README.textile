h1. Hearst Challenge

This project documents the participation of Jason Brownlee in the "Hearst Analytics Challenge":http://hearstchallenge.com/


h2. Provided Data

This section summarized the data that was provided on October 14th 2010.

The data includes  Sales, Issue, Store/Chain, Wholesaler and Zip+4 data between 2006 and 2009. The validation dataset is a subset of the broader modelling dataset.

h3. Data Files

* Data_Description_and_Problem_Statement for_Hearst_Challenge.xls : provides an summary of the problem, the data, and the relationship between the validation data tables.
* zip_plus4_data_[1-5].zip (5 files) : ?

h3. Modelling Data

The modelling data includes a large historic dataset from 2006 to 2009.

* Hearst_Challenge_Modeling_CSV_Files.zip : package of 4 modeling datasets8
** issue_mo_dataset.csv : 51885 records of 6 attributes (issue_key, CAN_COV_PRC, ISS_CD, US_COV_PRC, ON_SALE_DATE, OFF_SALE_DATE) with CAN_COV_PRC missing on many records.
** sales_mo_dataset.csv :  10,929,955 records of 9 attributes (wholesaler_key, chain_key, store_key, issue_key, dollar_volume, draw, returns, sales, title_key)
** store_mo_dataset.csv : 40,390 records of x (117?) attributes (...)
** wholesaler_mo_dataset.csv : 129 records of 3 attributes (wholesaler_key, CITY, ST)

h3. Validation Data

The validation dataset is a subset of the modelling dataset and is intended to be used to submit to the website.

* Hearst_Challenge_Validation_CSV_Files.zip : package containing 3 validation dataset
** sales_vd_dataset.csv : 709,265 records of 5 attributes (wholesaler_key, chain_key, store_key, issue_key, title_key).
** store_vd_dataset.csv : 2,500 records of 117 attributes (...)
** template_for_submission.csv : 492,100 records of 4 attributes (store_key, title_key, year_month, sales_total). This is the submission file without the predictions (order may be important).

Questions
* Is the validation dataset a true sub-set of the modelling data, if so, surely the monthly sales numbers are provided in the modelling dataset and can be used as a submission - achieving an RMSE of zero.

h3. Competition Data

A third set of data (the holdout set) will be provided at the end of the competition and will be used to determine the winner of the competition. This third dataset will include data from outside the 2006-2009 time period.

h3. Summary

Submissions are assessed based on the RMSE of the sales in the submission.

The objective is to predict the number of magazine units sold at a given store during a given month. Historic information can be deduced from the sales table, specifically the issue_key, store_key, and sales. The table appears to be missing date information. The date of the sames information could be deduced from the issue on-sale/off-sale dates. 

The problem is to predict monthly store/issue/sales numbers with no past information for specific months, only for issues? This means we don't know how issues behave over time, only holistically.

There is very little information about the magazines themselves. Most of the information is about the stores including the demographics for the store area and the store wholesaler. We have sales information for the store-issue and we have some very basic information about the issue such as its price. We have a magazine title key in the sale data to which to relate issues to each other.

We have a large amount of historic data and we are given a data sub-set of stores and sales data from which predictions must be made. It can be assumed that the provided data is a sub-set of the broader dataset, although has been removed. 

h2. Validation Data

h3. Summary Statistics: template_vd

The following provides summary statistics for the validation dataset (template_vd).

|_. Measures |_. Values |
| Total Records | 492100 |
| Total Stores | 2500 |
| Total Titles | 10 |
| Total Months | 29 |

|_. Measures |_. Values |
| Average Records/Month | 16968 |
| Average Stores/Month | 2468 |
| Average Titles/Month | 9 |
| Average Records/Store | 196 |
| Average Titles/Store | 7 |
| Average Records/Title | 49210 |
| Average Stores/Title | 1950 |

h3. Summary Statistics: sales_vd

The following provides summary statistics for the validation dataset (sales_vd).

|_. Measures |_. Values |
| Total Records | 709265 |
| Total Wholesalers | 40 |
| Total Chains | 85 |
| Total Stores | 2456 |
| Total Issues | 405 |
| Total Titles | 10 |

|_. Measures |_. Values |
| Average Records/Title | 70926 |
| Average Issues/Title | 40 |
| Average Stores/Title | 1945 |
| Average Chains/Title | 66 |
| Average Wholesalers/Title | 35 |

|_. Measures |_. Values |
| Average Records/Issue | 1751 |
| Average Wholesalers/Issue | 27 |
| Average Chains/Issue | 57 |
| Average Stores/Issue | 1719 |
| Average Titles/Issue | 1 |

|_. Measures |_. Values |
| Average Records/Store | 288 |
| Average Wholesalers/Store | 1 |
| Average Chains/Store | 1 |
| Average Issues/Store | 283 |
| Average Titles/Store | 7 |

|_. Measures |_. Values |
| Average Records/Chain | 8344 |
| Average Wholesalers/Chain | 2 |
| Average Stores/Chain | 28 |
| Average Issues/Chain | 272 |
| Average Titles/Chain | 7 |

|_. Measures |_. Values |
| Average Records/Wholesaler | 17731 |
| Average Store/Wholesaler | 108 |
| Average Chains/Wholesaler | 4 |
| Average Issues/Wholesaler | 275 |
| Average Titles/Wholesaler | 8 |


h3. Summary Statistics: stores_vd

The following provides summary statistics for the validation dataset (stores_vd).

TODO


h3. Summary

The required approach for the competition may be collaborative filtering where nearest-neighbour issues/titles are extracted from the historic corpus and used for prediction.

Are any of the titles in the larger corpus?
select count(*) from 
	(select distinct(sm.title_key) as sm_title_key from sales_mo sm) as a, 
	(select distinct(sd.title_key) as sd_title_key from sales_vd sd) as b
	where a.sm_title_key = b.sd_title_key;
- yes all 10

Are there any issues in the larger corpus?
select count(*) from 
	(select distinct(sm.issue_key) as sm_issue_key from sales_mo sm) as a, 
	(select distinct(sd.issue_key) as sd_issue_key from sales_vd sd) as b
	where a.sm_issue_key = b.sd_issue_key;
- yes all 405

this assumes a 1-to-1 relationship between issues and titles (an issue only belongs to one title)
- stats for both sales data tables confirm this

Are there any issues from the same months from the larger corpus?
?

How can we easily normalize corpus sales/months?
- a view on sales that includes the month

h2. Test Methodology

I guess cross-validate (n-fold, hold one out) the validation data

TODO derive submission style data from the broader corpus. 

select smo.store_key as store_key,
	smo.title_key as title_key,
	year(imo.on_sale_date) as sale_year,
	month(imo.on_sale_date) as sale_month,
	sum(smo.sales) as sales_total
from issue_mo imo, sales_mo smo
where smo.issue_key = imo.issue_key
group by smo.store_key, smo.title_key, year(imo.on_sale_date), month(imo.on_sale_date)


are there any issues that span more than one month?
- yes, heaps: 44371
select * from issue_mo
where month(on_sale_date) <> month(off_sale_date)

This means that special handling is needed when preparing the sales data

h2. Magazine

An analysis of magazine information

h2. Stores

An analysis of store information

h2. Sales

Summary statistics of the sales_mo table

|_. Measures |_. Values |
| Total Records | 10929954 |
| Total Wholesalers | 65 |
| Total Chains | 1013 |
| Total Stores | 39374 |
| Total Issues | 427 |
| Total Titles | 10 |

|_. Measures |_. Values |
| Average Records/Title | 1092995 |
| Average Issues/Title | 42 |
| Average Stores/Title | 30952 |
| Average Chains/Title | 818 |
| Average Wholesalers/Title | 60 |

|_. Measures |_. Values |
| Average Records/Issue | 25597 |
| Average Wholesalers/Issue | 46 |
| Average Chains/Issue | 686 |
| Average Stores/Issue | 25334 |
| Average Titles/Issue | 1 |

|_. Measures |_. Values |
| Average Records/Store | 277 |
| Average Wholesalers/Store | 1 |
| Average Chains/Store | 1 |
| Average Issues/Store | 274 |
| Average Titles/Store | 7 |

|_. Measures |_. Values |
| Average Records/Chain | 10789 |
| Average Wholesalers/Chain | 2 |
| Average Stores/Chain | 38 |
| Average Issues/Chain | 289 |
| Average Titles/Chain | 8 |

|_. Measures |_. Values |
| Average Records/Wholesaler | 168153 |
| Average Store/Wholesaler | 772 |
| Average Chains/Wholesaler | 35 |
| Average Issues/Wholesaler | 307 |
| Average Titles/Wholesaler | 9 |



h2. Demographics

An analysis of demographics information

h2. Issue

An analysis of issue information

h2. Wholesaler

An analysis of wholesaler information






h2.  Licenses

(c) Copyright 2010 Jason Brownlee. Some Rights Reserved.

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/au/">
        <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/2.5/au/88x31.png" />
</a>

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/au/">
Creative Commons Attribution-Noncommercial-Share Alike 2.5 Australia License</a>.
